# 按钮控制实现方案

## 需求分析
- 按钮连接到ESP32的46和20引脚
- 点击按钮：循环切换boot.py中的RUN_MODE（0-6）
- 长按按钮：重启设备

## 实现方案

### 1. 修改boot.py文件

#### 1.1 添加按钮初始化
- 初始化引脚46和20作为按钮输入
- 配置内部上拉电阻

#### 1.2 添加按钮事件检测
- 实现按钮点击检测（短按）
- 实现长按检测（超过2秒）

#### 1.3 修改主程序结构
- 将原有的RUN_MODE选择逻辑封装为函数
- 添加模式切换功能
- 实现长按重启功能

### 2. 具体代码实现

#### 2.1 按钮初始化代码
```python
# 按钮引脚配置
btn1 = Pin(46, Pin.IN, Pin.PULL_UP)  # 按钮1连接到引脚46
btn2 = Pin(20, Pin.IN, Pin.PULL_UP)  # 按钮2连接到引脚20
```

#### 2.2 按钮事件检测逻辑
- 检测按钮状态变化
- 区分短按和长按
- 实现模式循环切换

#### 2.3 主程序流程
1. 初始化按钮
2. 读取当前RUN_MODE
3. 检测按钮事件
4. 根据事件执行相应操作：
   - 短按：切换到下一个RUN_MODE
   - 长按：重启设备
5. 执行当前RUN_MODE对应的程序

### 3. 预期效果
- 点击按钮：循环切换7种运行模式
- 长按2秒以上：重启ESP32设备
- 模式切换后立即执行对应程序

## 注意事项
- 按钮引脚使用内部上拉电阻，确保稳定检测
- 长按检测时间设置为2秒，避免误触发
- 模式切换后会立即执行新的程序，无需手动重启
- 保留原有boot.py的所有功能，仅添加按钮控制逻辑